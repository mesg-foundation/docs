(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{427:function(e,t,a){"use strict";a.r(t);var s=a(33),n=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"dockerize-the-service"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerize-the-service"}},[e._v("#")]),e._v(" Dockerize the Service")]),e._v(" "),a("h2",{attrs:{id:"why-do-i-need-docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#why-do-i-need-docker"}},[e._v("#")]),e._v(" Why do I need Docker ?")]),e._v(" "),a("p",[e._v("Services run in Docker to provide a sandbox and a normalized environment to remove any side effects that may occur when running on many different machines. See more information on the "),a("a",{attrs:{href:"https://www.docker.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Docker website"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("h2",{attrs:{id:"steps-to-be-compatible-with-docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#steps-to-be-compatible-with-docker"}},[e._v("#")]),e._v(" Steps to be compatible with Docker")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#create-the-dockerfile"}},[e._v("Create the Dockerfile")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#add-a-configuration-and-dependencies"}},[e._v("Add a config")]),e._v(" in your "),a("RouterLink",{attrs:{to:"/guide/service/service-file.html"}},[a("code",[e._v("mesg.yml")])]),e._v(" file, if needed")],1),e._v(" "),a("li",[a("a",{attrs:{href:"#add-a-configuration-and-dependencies"}},[e._v("Add dependencies")]),e._v(" in your "),a("RouterLink",{attrs:{to:"/guide/service/service-file.html"}},[a("code",[e._v("mesg.yml")])]),e._v(" file, if needed")],1)]),e._v(" "),a("h2",{attrs:{id:"create-the-dockerfile"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#create-the-dockerfile"}},[e._v("#")]),e._v(" Create the Dockerfile")]),e._v(" "),a("p",[e._v("In order to be compatible with "),a("a",{attrs:{href:"https://www.docker.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Docker"),a("OutboundLink")],1),e._v(", a "),a("code",[e._v("Dockerfile")]),e._v(" needs to be created in the folder of the service. See the "),a("a",{attrs:{href:"https://docs.docker.com/engine/reference/builder/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Dockerfile reference"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("h3",{attrs:{id:"examples"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#examples"}},[e._v("#")]),e._v(" Examples")]),e._v(" "),a("vue-tabs",[a("v-tab",{attrs:{title:"Node","vp-markdown":""}},[a("div",{staticClass:"language-dockerfile extra-class"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("FROM")]),e._v(" node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("latest\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("WORKDIR")]),e._v(" /usr/src/app\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("COPY")]),e._v(" package*.json ./\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("RUN")]),e._v(" npm install\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("COPY")]),e._v(" . .\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("CMD")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"npm"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"start"')]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n")])])]),a("p",[e._v("Check out how to "),a("a",{attrs:{href:"https://nodejs.org/en/docs/guides/nodejs-docker-webapp/",target:"_blank",rel:"noopener noreferrer"}},[e._v("dockerizing a Node.js web app"),a("OutboundLink")],1),e._v(".")])]),e._v(" "),a("v-tab",{attrs:{title:"Go","vp-markdown":""}},[a("div",{staticClass:"language-dockerfile extra-class"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("FROM")]),e._v(" golang"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("latest\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("RUN")]),e._v(" mkdir /app\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("ADD")]),e._v(" . /app/\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("WORKDIR")]),e._v(" /app\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("RUN")]),e._v(" go build "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("o main .\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("CMD")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"/app/main"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n")])])]),a("p",[e._v("Check out how to "),a("a",{attrs:{href:"https://blog.codeship.com/building-minimal-docker-containers-for-go-applications/",target:"_blank",rel:"noopener noreferrer"}},[e._v("build a minimal Docker Containers for Go applications"),a("OutboundLink")],1),e._v(".")])])],1),e._v(" "),a("h2",{attrs:{id:"add-a-configuration-and-dependencies"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#add-a-configuration-and-dependencies"}},[e._v("#")]),e._v(" Add a configuration and dependencies")]),e._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),a("p",[e._v("Configuration and dependencies are an advanced feature and your service may not need them. This is totally optional and really depends on your service's needs.")])]),e._v(" "),a("p",[e._v("Once the Service can run on Docker, The Engine should be able to start it automatically. Update the "),a("RouterLink",{attrs:{to:"/guide/service/service-file.html"}},[a("code",[e._v("mesg.yml")])]),e._v(" file with the config. and optional dependencies the service needs.")],1),e._v(" "),a("p",[e._v("The "),a("code",[e._v("configuration")]),e._v(" key is a Dependency object that will be use to configure the main Docker container of the service. All Dependency attributes are available except image. The attribute "),a("code",[e._v("image")]),e._v(" will be set automatically when the service is deployed.")]),e._v(" "),a("p",[e._v("If the service requires dependencies to other Docker container, specify them in the "),a("code",[e._v("dependencies")]),e._v(" map.")]),e._v(" "),a("h3",{attrs:{id:"definitions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#definitions"}},[e._v("#")]),e._v(" Definitions")]),e._v(" "),a("table",[a("thead",[a("tr",[a("th",[a("strong",[e._v("Attribute")])]),e._v(" "),a("th",[a("strong",[e._v("Type")])]),e._v(" "),a("th",[a("strong",[e._v("Default")])]),e._v(" "),a("th",[a("strong",[e._v("Description")])])])]),e._v(" "),a("tbody",[a("tr",[a("td",[a("strong",[e._v("image")])]),e._v(" "),a("td",[a("code",[e._v("String")])]),e._v(" "),a("td",[a("code",[e._v('""')])]),e._v(" "),a("td",[e._v("The docker image of the Service. Only available for dependencies.")])]),e._v(" "),a("tr",[a("td",[a("strong",[e._v("volumes")])]),e._v(" "),a("td",[a("code",[e._v("String[]")])]),e._v(" "),a("td",[a("code",[e._v("[]")])]),e._v(" "),a("td",[e._v("A list of "),a("a",{attrs:{href:"https://docs.docker.com/storage/volumes/",target:"_blank",rel:"noopener noreferrer"}},[e._v("volumes"),a("OutboundLink")],1),e._v(" that will be mounted in the Service.")])]),e._v(" "),a("tr",[a("td",[a("strong",[e._v("ports")])]),e._v(" "),a("td",[a("code",[e._v("String[]")])]),e._v(" "),a("td",[a("code",[e._v("[]")])]),e._v(" "),a("td",[e._v("A list of ports that the Service needs to expose.")])]),e._v(" "),a("tr",[a("td",[a("strong",[e._v("command")])]),e._v(" "),a("td",[a("code",[e._v("String")])]),e._v(" "),a("td",[a("code",[e._v('""')])]),e._v(" "),a("td",[e._v("The command to run when the Service starts if not defined in your "),a("a",{attrs:{href:"#create-the-dockerfile"}},[e._v("Dockerfile")]),e._v(".")])]),e._v(" "),a("tr",[a("td",[a("strong",[e._v("volumesFrom")])]),e._v(" "),a("td",[a("code",[e._v("String[]")])]),e._v(" "),a("td",[a("code",[e._v("[]")])]),e._v(" "),a("td",[e._v("List of dependencies' names to mount a volume from.")])]),e._v(" "),a("tr",[a("td",[a("strong",[e._v("env")])]),e._v(" "),a("td",[a("code",[e._v("String[]")])]),e._v(" "),a("td",[a("code",[e._v("[]")])]),e._v(" "),a("td",[e._v("List of environmental variables needed for the dependency with the format "),a("code",[e._v("KEY=VALUE")]),e._v(".")])])])]),e._v(" "),a("h3",{attrs:{id:"example"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#example"}},[e._v("#")]),e._v(" Example")]),e._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" serviceX\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("tasks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("events")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("configuration")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("command")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"node start"')]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("volumesFrom")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" serviceToConnectWith\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("env")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" FOO=BAR\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("dependencies")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("serviceToConnectWith")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"..."')]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("volumes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"/tmp"')]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("ports")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"1234"')]),e._v("\n")])])]),a("p",[e._v("Each dependency's key is used as its "),a("strong",[e._v("hostname")]),e._v(" on the shared network between the service and dependencies.\nIn this example, the service can access the dependency at the endpoint "),a("code",[e._v("serviceToConnectWith:1234")]),e._v(".")]),e._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[e._v("Get Help")]),e._v(" "),a("p",[e._v("You need help ? Check out the "),a("a",{attrs:{href:"https://forum.mesg.com",target:"_blank"}},[e._v("MESG Forum")]),e._v(".")])])],1)}),[],!1,null,null,null);t.default=n.exports}}]);